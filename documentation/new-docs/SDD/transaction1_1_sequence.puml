@startuml
' User Registration - Sequence Diagram
actor User
participant RegisterForm as "RegisterForm (React)"
participant AuthStore as "AuthStore (Zustand)"
participant AuthServiceFrontend as "AuthService (frontend)"
participant API as "API /auth/register"
participant AuthController as "AuthController (backend)"
participant AuthService as "AuthService (backend)"
participant Account as "Account (DB Entity)"

User -> RegisterForm: Fill registration form
RegisterForm -> AuthStore: register(data)
AuthStore -> AuthServiceFrontend: register(data)
AuthServiceFrontend -> API: POST /auth/register
API -> AuthController: register(req, res)
AuthController -> AuthService: findByEmailOrUsername()
AuthService -> Account: query (email/username)
Account --> AuthService: result
AuthService --> AuthController: exists?
alt Exists
  AuthController --> API: 409 Conflict (error)
  API --> AuthServiceFrontend: error
  AuthServiceFrontend --> AuthStore: error
  AuthStore --> RegisterForm: show error
else Not exists
  AuthController -> AuthService: createUser()
  AuthService -> Account: save(new user)
  Account --> AuthService: created
  AuthService --> AuthController: user
  AuthController --> API: 201 Created (user)
  API --> AuthServiceFrontend: success
  AuthServiceFrontend --> AuthStore: success
  AuthStore --> RegisterForm: show success
end
RegisterForm --> User: Success/Error feedback
@enduml 